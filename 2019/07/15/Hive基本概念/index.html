<!DOCTYPE html>


<html lang="zh-CN">
  

    <head>
      <meta charset="utf-8" />
        
      <meta
        name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1"
      />
      <title>Hive基本概念 |  Movle</title>
  <meta name="generator" content="hexo-theme-ayer">
      
      <link rel="shortcut icon" href="https://img-blog.csdnimg.cn/20200609161448519.jpg" />
       
<link rel="stylesheet" href="/dist/main.css">

      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/css/remixicon.min.css"
      />
      
<link rel="stylesheet" href="/css/custom.css">
 
      <script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>
       
 

      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/@sweetalert2/theme-bulma@5.0.1/bulma.min.css"
      />
      <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.js"></script>

      <!-- mermaid -->
      
      <style>
        .swal2-styled.swal2-confirm {
          font-size: 1.6rem;
        }
      </style>
    </head>
  </html>
</html>


<body>
  <div id="app">
    
      
    <main class="content on">
      <section class="outer">
  <article
  id="post-Hive基本概念"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h1 class="article-title sea-center" style="border-left:0" itemprop="name">
  Hive基本概念
</h1>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2019/07/15/Hive%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/" class="article-date">
  <time datetime="2019-07-15T03:00:00.000Z" itemprop="datePublished">2019-07-15</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/Hive/">Hive</a>
  </div>
  
<div class="word_count">
    <span class="post-time">
        <span class="post-meta-item-icon">
            <i class="ri-quill-pen-line"></i>
            <span class="post-meta-item-text"> 字数统计:</span>
            <span class="post-count">2.8k</span>
        </span>
    </span>

    <span class="post-time">
        &nbsp; | &nbsp;
        <span class="post-meta-item-icon">
            <i class="ri-book-open-line"></i>
            <span class="post-meta-item-text"> 阅读时长≈</span>
            <span class="post-count">11 分钟</span>
        </span>
    </span>
</div>
 
    </div>
      
    <div class="tocbot"></div>




  
    <div class="article-entry" itemprop="articleBody">
       
  <h3 id="一-Hive基本概念："><a href="#一-Hive基本概念：" class="headerlink" title="一.Hive基本概念："></a>一.Hive基本概念：</h3><h4 id="1-Hive"><a href="#1-Hive" class="headerlink" title="1. Hive"></a>1. Hive</h4><h5 id="1-官网：http-hive-apache-org"><a href="#1-官网：http-hive-apache-org" class="headerlink" title="(1).官网：http://hive.apache.org/"></a>(1).官网：<a target="_blank" rel="noopener" href="http://hive.apache.org/">http://hive.apache.org/</a></h5><h5 id="2-Apache-HiveTM数据仓库软件有助于使用SQL读取，编写和管理驻留在分布式存储中的-大型数据集。可以将结构投影到已存储的数据中。提供了命令行工具和JDBC驱动程序以-将用户连接到Hive。"><a href="#2-Apache-HiveTM数据仓库软件有助于使用SQL读取，编写和管理驻留在分布式存储中的-大型数据集。可以将结构投影到已存储的数据中。提供了命令行工具和JDBC驱动程序以-将用户连接到Hive。" class="headerlink" title="(2).Apache HiveTM数据仓库软件有助于使用SQL读取，编写和管理驻留在分布式存储中的 大型数据集。可以将结构投影到已存储的数据中。提供了命令行工具和JDBC驱动程序以 将用户连接到Hive。"></a>(2).Apache HiveTM数据仓库软件有助于使用SQL读取，编写和管理驻留在分布式存储中的 大型数据集。可以将结构投影到已存储的数据中。提供了命令行工具和JDBC驱动程序以 将用户连接到Hive。</h5><h5 id="3-hive提供了SQL查询功能-hdfs分布式存储"><a href="#3-hive提供了SQL查询功能-hdfs分布式存储" class="headerlink" title="(3).hive提供了SQL查询功能 hdfs分布式存储"></a>(3).hive提供了SQL查询功能 hdfs分布式存储</h5><h5 id="4-hive本质HQL转化为MapReduce程序。"><a href="#4-hive本质HQL转化为MapReduce程序。" class="headerlink" title="(4).hive本质HQL转化为MapReduce程序。"></a>(4).hive本质HQL转化为MapReduce程序。</h5><h5 id="5-环境前提："><a href="#5-环境前提：" class="headerlink" title="(5).环境前提："></a>(5).环境前提：</h5><ul>
<li>启动hdfs集群</li>
<li>启动yarn集群</li>
</ul>
<p>如果想用hive的话，需要提前安装部署好hadoop集群。</p>
<h4 id="2-为什么要学习Hive"><a href="#2-为什么要学习Hive" class="headerlink" title="2.为什么要学习Hive"></a>2.为什么要学习Hive</h4><h5 id="1-简化开发"><a href="#1-简化开发" class="headerlink" title="(1).简化开发"></a>(1).简化开发</h5><h5 id="2-优势："><a href="#2-优势：" class="headerlink" title="(2).优势："></a>(2).优势：</h5><h6 id="a-操作接口采用类SQL语法，提供快速开发的能力（简单、容易上手）"><a href="#a-操作接口采用类SQL语法，提供快速开发的能力（简单、容易上手）" class="headerlink" title="(a)操作接口采用类SQL语法，提供快速开发的能力（简单、容易上手）"></a>(a)操作接口采用类SQL语法，提供快速开发的能力（简单、容易上手）</h6><h6 id="b-避免了去写MapReduce，减少开发人员的学习成本。"><a href="#b-避免了去写MapReduce，减少开发人员的学习成本。" class="headerlink" title="(b)避免了去写MapReduce，减少开发人员的学习成本。"></a>(b)避免了去写MapReduce，减少开发人员的学习成本。</h6><h6 id="c-Hive的执行延迟比较高，因此Hive常用于数据分析，对实时性要求不高的场合"><a href="#c-Hive的执行延迟比较高，因此Hive常用于数据分析，对实时性要求不高的场合" class="headerlink" title="(c )Hive的执行延迟比较高，因此Hive常用于数据分析，对实时性要求不高的场合"></a>(c )Hive的执行延迟比较高，<strong>因此Hive常用于数据分析，对实时性要求不高的场合</strong></h6><h6 id="d-Hive优势在于处理大数据，对于处理小数据没有优势，因为Hive的执行延迟比较高"><a href="#d-Hive优势在于处理大数据，对于处理小数据没有优势，因为Hive的执行延迟比较高" class="headerlink" title="(d)Hive优势在于处理大数据，对于处理小数据没有优势，因为Hive的执行延迟比较高"></a>(d)Hive优势在于处理大数据，<strong>对于处理小数据没有优势，因为Hive的执行延迟比较高</strong></h6><h6 id="e-Hive支持用户自定义函数，用户可以根据自己的需求来实现自己的函数。"><a href="#e-Hive支持用户自定义函数，用户可以根据自己的需求来实现自己的函数。" class="headerlink" title="(e)Hive支持用户自定义函数，用户可以根据自己的需求来实现自己的函数。"></a>(e)Hive支持用户自定义函数，用户可以根据自己的需求来实现自己的函数。</h6><h4 id="3-劣势："><a href="#3-劣势：" class="headerlink" title="3.劣势："></a>3.劣势：</h4><h5 id="1-Hive的HQL表达能力有限"><a href="#1-Hive的HQL表达能力有限" class="headerlink" title="(1)Hive的HQL表达能力有限"></a>(1)Hive的HQL表达能力有限</h5><ul>
<li>迭代式算法无法表达</li>
<li>数据挖掘方面不擅长</li>
</ul>
<h5 id="2-Hive的效率比较低"><a href="#2-Hive的效率比较低" class="headerlink" title="(2)Hive的效率比较低"></a>(2)Hive的效率比较低</h5><ul>
<li>Hive自动生成的MapReduce作业，通常情况下不够智能化</li>
<li>Hive调优比较困难，粒度较粗</li>
</ul>
<h4 id="3-Hive架构原理："><a href="#3-Hive架构原理：" class="headerlink" title="3.Hive架构原理："></a>3.Hive架构原理：</h4><p>sql-&gt;转换-&gt;mapreduce-&gt;job</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy80MzkxNDA3LTYxZTllNDdlZjQ0MmM2NGIucG5n?x-oss-process=image/format,png" alt="Hive架构原理"></p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy80MzkxNDA3LTQ4MTE5MzczZDk2MmM2MDQucG5n?x-oss-process=image/format,png" alt="Hive架构"></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;如图中所示，Hive通过给用户提供的一系列交互接口，接收到用户的指令(SQL)，使用自己的Driver，结合元数据(MetaStore)，将这些指令翻译成MapReduce，提交到Hadoop中执行，最后，将执行返回的结果输出到用户交互接口。</p>
<h5 id="1-用户接口：Client"><a href="#1-用户接口：Client" class="headerlink" title="(1).用户接口：Client"></a>(1).用户接口：Client</h5><p>CLI(hive shell)、JDBC/ODBC(java访问hive)、WEBUI(浏览器访问hive)</p>
<h5 id="2-元数据：Metastore"><a href="#2-元数据：Metastore" class="headerlink" title="(2).元数据：Metastore"></a>(2).元数据：Metastore</h5><p>&nbsp;&nbsp;&nbsp;&nbsp;元数据包括：表名、表所属的数据库（默认是default）、表的拥有者、列/分区字段、表的类型（是否是外部表）、表的数据所在目录等；<br>&nbsp;&nbsp;&nbsp;&nbsp;默认存储在自带的derby数据库中，推荐使用MySQL存储Metastore</p>
<h5 id="3-Hadoop"><a href="#3-Hadoop" class="headerlink" title="(3).Hadoop"></a>(3).Hadoop</h5><p>&nbsp;&nbsp;&nbsp;&nbsp;使用HDFS进行存储，使用MapReduce进行计算。</p>
<h5 id="4-驱动器：Driver"><a href="#4-驱动器：Driver" class="headerlink" title="(4).驱动器：Driver"></a>(4).驱动器：Driver</h5><h6 id="a-解析器-SQL-Parser-："><a href="#a-解析器-SQL-Parser-：" class="headerlink" title="(a)解析器(SQL Parser)："></a>(a)解析器(SQL Parser)：</h6><p>将SQL字符串转换成抽象语法树AST，这一步一般都用第三方工具库完成，比如antlr；对AST进行语法分析，比如表是否存在、字段是否存在、SQL语义是否有误。</p>
<h6 id="b-编译器-Physical-Plan-："><a href="#b-编译器-Physical-Plan-：" class="headerlink" title="(b)编译器(Physical Plan)："></a>(b)编译器(Physical Plan)：</h6><p>将AST编译生成逻辑执行计划。</p>
<h6 id="c-优化器-Query-Optimizer-："><a href="#c-优化器-Query-Optimizer-：" class="headerlink" title="(c )优化器(Query Optimizer)："></a>(c )优化器(Query Optimizer)：</h6><p>对逻辑执行计划进行优化。</p>
<h6 id="d-执行器-Execution-："><a href="#d-执行器-Execution-：" class="headerlink" title="(d)执行器(Execution)："></a>(d)执行器(Execution)：</h6><p>把逻辑执行计划转换成可以运行的物理计划。对于Hive来说，就是MR/Spark。</p>
<h4 id="4-Hive和数据库比较"><a href="#4-Hive和数据库比较" class="headerlink" title="4.Hive和数据库比较"></a>4.Hive和数据库比较</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;由于 Hive 采用了类似SQL 的查询语言 HQL(Hive Query Language)，因此很容易将 Hive 理解为数据库。其实从结构上来看，Hive 和数据库除了拥有类似的查询语言，再无类似之处。本文将从多个方面来阐述 Hive 和数据库的差异。数据库可以用在 Online 的应用中，但是Hive 是为数据仓库而设计的，清楚这一点，有助于从应用角度理解 Hive 的特性。</p>
<h5 id="1-查询语言"><a href="#1-查询语言" class="headerlink" title="(1).查询语言"></a>(1).查询语言</h5><p>&nbsp;&nbsp;&nbsp;&nbsp;由于SQL被广泛的应用在数据仓库中，因此，专门针对Hive的特性设计了类SQL的查询语言HQL。熟悉SQL开发的开发者可以很方便的使用Hive进行开发。</p>
<h5 id="2-数据存储位置"><a href="#2-数据存储位置" class="headerlink" title="(2).数据存储位置"></a>(2).数据存储位置</h5><p>&nbsp;&nbsp;&nbsp;&nbsp;Hive 是建立在 Hadoop 之上的，所有 Hive 的数据都是存储在 HDFS 中的。而数据库则可以将数据保存在块设备或者本地文件系统中。</p>
<h5 id="3-数据更新"><a href="#3-数据更新" class="headerlink" title="(3). 数据更新"></a>(3). 数据更新</h5><p>&nbsp;&nbsp;&nbsp;&nbsp;由于Hive是针对数据仓库应用设计的，而数据仓库的内容是读多写少的。因此，Hive中不支持对数据的改写和添加，所有的数据都是在加载的时候确定好的。而数据库中的数据通常是需要经常进行修改的，因此可以使用 INSERT INTO …  VALUES 添加数据，使用 UPDATE … SET修改数据。</p>
<h5 id="4-索引"><a href="#4-索引" class="headerlink" title="(4). 索引"></a>(4). 索引</h5><p>&nbsp;&nbsp;&nbsp;&nbsp;Hive在加载数据的过程中不会对数据进行任何处理，甚至不会对数据进行扫描，因此也没有对数据中的某些Key建立索引。Hive要访问数据中满足条件的特定值时，需要暴力扫描整个数据，因此访问延迟较高。由于 MapReduce 的引入， Hive 可以并行访问数据，因此即使没有索引，对于大数据量的访问，Hive 仍然可以体现出优势。数据库中，通常会针对一个或者几个列建立索引，因此对于少量的特定条件的数据的访问，数据库可以有很高的效率，较低的延迟。由于数据的访问延迟较高，决定了 Hive 不适合在线数据查询。</p>
<h5 id="5-执行"><a href="#5-执行" class="headerlink" title="(5). 执行"></a>(5). 执行</h5><p>&nbsp;&nbsp;&nbsp;&nbsp;Hive中大多数查询的执行是通过 Hadoop 提供的 MapReduce 来实现的。而数据库通常有自己的执行引擎。</p>
<h5 id="6-执行延迟"><a href="#6-执行延迟" class="headerlink" title="(6). 执行延迟"></a>(6). 执行延迟</h5><p>&nbsp;&nbsp;&nbsp;&nbsp;Hive 在查询数据的时候，由于没有索引，需要扫描整个表，因此延迟较高。另外一个导致 Hive 执行延迟高的因素是 MapReduce框架。由于MapReduce 本身具有较高的延迟，因此在利用MapReduce 执行Hive查询时，也会有较高的延迟。相对的，数据库的执行延迟较低。当然，这个低是有条件的，即数据规模较小，当数据规模大到超过数据库的处理能力的时候，Hive的并行计算显然能体现出优势。</p>
<h5 id="7-可扩展性"><a href="#7-可扩展性" class="headerlink" title="(7).可扩展性"></a>(7).可扩展性</h5><p>&nbsp;&nbsp;&nbsp;&nbsp;由于Hive是建立在Hadoop之上的，因此Hive的可扩展性是和Hadoop的可扩展性是一致的(世界上最大的Hadoop 集群在 Yahoo!，2009年的规模在4000 台节点左右)。而数据库由于 ACID 语义的严格限制，扩展行非常有限。目前最先进的并行数据库Oracle在理论上的扩展能力也只有100台左右。</p>
<h5 id="8-数据规模"><a href="#8-数据规模" class="headerlink" title="(8). 数据规模"></a>(8). 数据规模</h5><p>&nbsp;&nbsp;&nbsp;&nbsp;由于Hive建立在集群上并可以利用MapReduce进行并行计算，因此可以支持很大规模的数据；对应的，数据库可以支持的数据规模较小。</p>
<h3 id="二-Hive数据类型"><a href="#二-Hive数据类型" class="headerlink" title="二.Hive数据类型"></a>二.Hive数据类型</h3><h4 id="1-基本数据类型"><a href="#1-基本数据类型" class="headerlink" title="1.基本数据类型"></a>1.基本数据类型</h4><table>
<thead>
<tr>
<th align="center">Hive数据类型</th>
<th align="center">Java数据类型</th>
<th align="center">长度</th>
<th align="center">例子</th>
</tr>
</thead>
<tbody><tr>
<td align="center">TINYINT</td>
<td align="center">byte</td>
<td align="center">1byte有符号整数</td>
<td align="center">20</td>
</tr>
<tr>
<td align="center">SMALINT</td>
<td align="center">short</td>
<td align="center">2byte有符号整数</td>
<td align="center">20</td>
</tr>
<tr>
<td align="center">INT</td>
<td align="center">int</td>
<td align="center">4byte有符号整数</td>
<td align="center">20</td>
</tr>
<tr>
<td align="center">BIGINT</td>
<td align="center">long</td>
<td align="center">8byte有符号整数</td>
<td align="center">20</td>
</tr>
<tr>
<td align="center">BOOLEAN</td>
<td align="center">boolean</td>
<td align="center">布尔类型，true或者false</td>
<td align="center">TRUE  FALSE</td>
</tr>
<tr>
<td align="center">FLOAT</td>
<td align="center">float</td>
<td align="center">单精度浮点数</td>
<td align="center">3.14159</td>
</tr>
<tr>
<td align="center">DOUBLE</td>
<td align="center">double</td>
<td align="center">双精度浮点数</td>
<td align="center">3.14159</td>
</tr>
<tr>
<td align="center">STRING</td>
<td align="center">string</td>
<td align="center">字符系列。可以指定字符集。可以使用单引号或者双引号</td>
<td align="center">‘now is the time’ “for all good men”</td>
</tr>
<tr>
<td align="center">TIMESTAMP</td>
<td align="center"></td>
<td align="center">时间类型</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">BINARY</td>
<td align="center"></td>
<td align="center">字节数组</td>
<td align="center"></td>
</tr>
</tbody></table>
<p>&nbsp;&nbsp;&nbsp;&nbsp;对于Hive的String类型相当于数据库的varchar类型，该类型是一个可变的字符串，不过它不能 其中最多能存储多少个字符，理论上它可以存储2GB的字符数。</p>
<h4 id="2-集合数据类型"><a href="#2-集合数据类型" class="headerlink" title="2.集合数据类型"></a>2.集合数据类型</h4><table>
<thead>
<tr>
<th align="center">数据类型</th>
<th align="center">描述</th>
<th align="center">语法示例</th>
</tr>
</thead>
<tbody><tr>
<td align="center">STRUCT</td>
<td align="center">和c语言中的struct类似，都可以通过“点”符号访问元素内容。例如，如果某个列的数据类型是STRUCT{first STRING, last STRING},那么第1个元素可以通过字段.first来引用</td>
<td align="center">struct()</td>
</tr>
<tr>
<td align="center">MAP</td>
<td align="center">MAP是一组键-值对元组集合，使用数组表示法可以访问数据。例如，如果某个列的数据类型是MAP，其中键-&gt;值对是’first’-&gt;’John’和’last’-&gt;’Doe’，那么可以通过字段名[‘last’]获取最后一个元素</td>
<td align="center">map()</td>
</tr>
<tr>
<td align="center">ARRAY</td>
<td align="center">数组是一组具有相同类型和名称的变量的集合。这些变量称为数组的元素，每个数组元素都有一个编号，编号从零开始。例如，数组值为[‘John’, ‘Doe’]，那么第2个元素可以通过数组名[1]进行引用</td>
<td align="center">Array()</td>
</tr>
</tbody></table>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Hive有三种复杂数据类型ARRAY、MAP 和 STRUCT。ARRAY和MAP与Java中的Array和Map类似，而STRUCT与C语言中的Struct类似，它封装了一个命名字段集合，复杂数据类型允许任意层次的嵌套。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create table heheee(`来试试` string,`来试试1` string,`来试试2` string) row format delimited fields terminated by &#x27;\t&#x27;;</span><br></pre></td></tr></table></figure>

<p><strong>案例实操</strong></p>
<h5 id="1-假设某表有如下一行，我们用JSON格式来表示其数据结构。在Hive下访问的格式为"><a href="#1-假设某表有如下一行，我们用JSON格式来表示其数据结构。在Hive下访问的格式为" class="headerlink" title="(1)假设某表有如下一行，我们用JSON格式来表示其数据结构。在Hive下访问的格式为"></a>(1)假设某表有如下一行，我们用JSON格式来表示其数据结构。在Hive下访问的格式为</h5><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;songsong&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;friends&quot;</span>: [<span class="string">&quot;bingbing&quot;</span> , <span class="string">&quot;lili&quot;</span>] ,       <span class="comment">//列表Array, </span></span><br><span class="line">    <span class="attr">&quot;children&quot;</span>: &#123;                      <span class="comment">//键值Map,</span></span><br><span class="line">        <span class="attr">&quot;xiao song&quot;</span>: <span class="number">18</span> ,</span><br><span class="line">        <span class="attr">&quot;xiaoxiao song&quot;</span>: <span class="number">19</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="string">&quot;address&quot;</span>: &#123;                      <span class="comment">//结构Struct,</span></span><br><span class="line">        <span class="attr">&quot;street&quot;</span>: <span class="string">&quot;hai dian qu&quot;</span> ,</span><br><span class="line">        <span class="attr">&quot;city&quot;</span>: <span class="string">&quot;beijing&quot;</span> </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="2-基于上述数据结构，我们在Hive里创建对应的表，并导入数据。"><a href="#2-基于上述数据结构，我们在Hive里创建对应的表，并导入数据。" class="headerlink" title="(2)基于上述数据结构，我们在Hive里创建对应的表，并导入数据。"></a>(2)基于上述数据结构，我们在Hive里创建对应的表，并导入数据。</h5><p>创建本地测试文件test.txt</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /opt/module/datas/</span><br><span class="line"></span><br><span class="line">touch text.txt</span><br></pre></td></tr></table></figure>
<p>添加内容：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">songsong,bingbing_lili,xiao song:18_xiaoxiao song:19,hai dian qu_beijing</span><br><span class="line"></span><br><span class="line">yangyang,caicai_susu,xiao yang:18_xiaoxiao yang:19,chao yang_beijing</span><br></pre></td></tr></table></figure>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy80MzkxNDA3LTcxNmExMWVlMzA4MTQxM2IucG5n?x-oss-process=image/format,png"></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;注意，MAP，STRUCT和ARRAY里的元素间关系都可以用同一个字符表示，这里用“_”。</p>
<h5 id="3-Hive上创建测试表test"><a href="#3-Hive上创建测试表test" class="headerlink" title="(3)Hive上创建测试表test"></a>(3)Hive上创建测试表test</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">create table test(</span><br><span class="line">name string,</span><br><span class="line">friends array&lt;string&gt;,</span><br><span class="line">children map&lt;string, int&gt;,</span><br><span class="line">address struct&lt;street:string, city:string&gt;</span><br><span class="line">)</span><br><span class="line">row format delimited fields terminated by &#x27;,&#x27;</span><br><span class="line">collection items terminated by &#x27;_&#x27;</span><br><span class="line">map keys terminated by &#x27;:&#x27;</span><br><span class="line">lines terminated by &#x27;\n&#x27;;</span><br></pre></td></tr></table></figure>

<p>字段解释：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">row format delimited fields terminated by &#x27;,&#x27;     -- 列分隔符</span><br><span class="line">collection items terminated by &#x27;_&#x27;  	          --MAP STRUCT 和 ARRAY 的分隔符(数据分割符号)</span><br><span class="line">map keys terminated by &#x27;:&#x27;				          -- MAP中的key与value的分隔符</span><br><span class="line">lines terminated by &#x27;\n&#x27;;					      -- 行分隔符</span><br></pre></td></tr></table></figure>

<h5 id="4-导入文本数据到测试表"><a href="#4-导入文本数据到测试表" class="headerlink" title="(4)导入文本数据到测试表"></a>(4)导入文本数据到测试表</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">load data local inpath &#x27;/opt/module/datas/text.txt&#x27; into table test;</span><br></pre></td></tr></table></figure>
<h5 id="5-访问三种集合列里的数据，以下分别是ARRAY，MAP，STRUCT的访问方式"><a href="#5-访问三种集合列里的数据，以下分别是ARRAY，MAP，STRUCT的访问方式" class="headerlink" title="(5)访问三种集合列里的数据，以下分别是ARRAY，MAP，STRUCT的访问方式"></a>(5)访问三种集合列里的数据，以下分别是ARRAY，MAP，STRUCT的访问方式</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select friends[1],children[&#x27;xiao song&#x27;],address.city from test where name=&quot;songsong&quot;;</span><br></pre></td></tr></table></figure>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy80MzkxNDA3LWJkZDgzYzNiZjk5ZjM4NjUucG5n?x-oss-process=image/format,png"></p>
<p>如果起别名：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select friends[1] as pengyou from test where name=&quot;songsong&quot;;</span><br></pre></td></tr></table></figure>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy80MzkxNDA3LTFmMWY3MDg3ZmFlMGQ3MTAucG5n?x-oss-process=image/format,png"></p>
<h4 id="3-类型转化"><a href="#3-类型转化" class="headerlink" title="3.类型转化"></a>3.类型转化</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;Hive的原子数据类型是可以进行隐式转换的，类似于Java的类型转换，例如某表达式使用INT类型，TINYINT会自动转换为INT类型，但是Hive不会进行反向转化，例如，某表达式使用TINYINT类型，INT不会自动转换为TINYINT类型，它会返回错误，除非使用CAST操作。</p>
<h5 id="1-隐式类型转换规则如下。"><a href="#1-隐式类型转换规则如下。" class="headerlink" title="(1).隐式类型转换规则如下。"></a>(1).隐式类型转换规则如下。</h5><h6 id="a-任何整数类型都可以隐式地转换为一个范围更广的类型，如TINYINT可以转换成INT，INT可以转换成BIGINT。"><a href="#a-任何整数类型都可以隐式地转换为一个范围更广的类型，如TINYINT可以转换成INT，INT可以转换成BIGINT。" class="headerlink" title="(a)任何整数类型都可以隐式地转换为一个范围更广的类型，如TINYINT可以转换成INT，INT可以转换成BIGINT。"></a>(a)任何整数类型都可以隐式地转换为一个范围更广的类型，如TINYINT可以转换成INT，INT可以转换成BIGINT。</h6><h6 id="b-所有整数类型、FLOAT和STRING类型都可以隐式地转换成DOUBLE。"><a href="#b-所有整数类型、FLOAT和STRING类型都可以隐式地转换成DOUBLE。" class="headerlink" title="(b)所有整数类型、FLOAT和STRING类型都可以隐式地转换成DOUBLE。"></a>(b)所有整数类型、FLOAT和STRING类型都可以隐式地转换成DOUBLE。</h6><h6 id="c-TINYINT、SMALLINT、INT都可以转换为FLOAT。"><a href="#c-TINYINT、SMALLINT、INT都可以转换为FLOAT。" class="headerlink" title="(c )TINYINT、SMALLINT、INT都可以转换为FLOAT。"></a>(c )TINYINT、SMALLINT、INT都可以转换为FLOAT。</h6><h6 id="d-BOOLEAN类型不可以转换为任何其它的类型。"><a href="#d-BOOLEAN类型不可以转换为任何其它的类型。" class="headerlink" title="(d)BOOLEAN类型不可以转换为任何其它的类型。"></a>(d)BOOLEAN类型不可以转换为任何其它的类型。</h6><h5 id="2-可以使用CAST操作显示进行数据类型转换，"><a href="#2-可以使用CAST操作显示进行数据类型转换，" class="headerlink" title="(2).可以使用CAST操作显示进行数据类型转换，"></a>(2).可以使用CAST操作显示进行数据类型转换，</h5><p>&nbsp;&nbsp;&nbsp;&nbsp;例如CAST(‘1’ AS INT)将把字符串’1’ 转换成整数1；如果强制类型转换失败，如执行CAST(‘X’ AS INT)，表达式返回空值 NULL。</p>
 
      <!-- reward -->
      
      <div id="reword-out">
        <div id="reward-btn">
          打赏
        </div>
      </div>
      
    </div>
    

    <!-- copyright -->
    
    <div class="declare">
      <ul class="post-copyright">
        <li>
          <i class="ri-copyright-line"></i>
          <strong>版权声明： </strong>
          
          本博客所有文章除特别声明外，著作权归作者所有。转载请注明出处！
          
        </li>
      </ul>
    </div>
    
    <footer class="article-footer">
       
<div class="share-btn">
      <span class="share-sns share-outer">
        <i class="ri-share-forward-line"></i>
        分享
      </span>
      <div class="share-wrap">
        <i class="arrow"></i>
        <div class="share-icons">
          
          <a class="weibo share-sns" href="javascript:;" data-type="weibo">
            <i class="ri-weibo-fill"></i>
          </a>
          <a class="weixin share-sns wxFab" href="javascript:;" data-type="weixin">
            <i class="ri-wechat-fill"></i>
          </a>
          <a class="qq share-sns" href="javascript:;" data-type="qq">
            <i class="ri-qq-fill"></i>
          </a>
          <a class="douban share-sns" href="javascript:;" data-type="douban">
            <i class="ri-douban-line"></i>
          </a>
          <!-- <a class="qzone share-sns" href="javascript:;" data-type="qzone">
            <i class="icon icon-qzone"></i>
          </a> -->
          
          <a class="facebook share-sns" href="javascript:;" data-type="facebook">
            <i class="ri-facebook-circle-fill"></i>
          </a>
          <a class="twitter share-sns" href="javascript:;" data-type="twitter">
            <i class="ri-twitter-fill"></i>
          </a>
          <a class="google share-sns" href="javascript:;" data-type="google">
            <i class="ri-google-fill"></i>
          </a>
        </div>
      </div>
</div>

<div class="wx-share-modal">
    <a class="modal-close" href="javascript:;"><i class="ri-close-circle-line"></i></a>
    <p>扫一扫，分享到微信</p>
    <div class="wx-qrcode">
      <img src="//api.qrserver.com/v1/create-qr-code/?size=150x150&data=http://example.com/2019/07/15/Hive%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/" alt="微信分享二维码">
    </div>
</div>

<div id="share-mask"></div>  
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Hive/" rel="tag">Hive</a></li></ul>

    </footer>
  </div>

   
  <nav class="article-nav">
    
      <a href="/2019/07/15/Hive%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/" class="article-nav-link">
        <strong class="article-nav-caption">上一篇</strong>
        <div class="article-nav-title">
          
            Hive安装部署
          
        </div>
      </a>
    
    
      <a href="/2019/07/03/Flume%E6%8B%A6%E6%88%AA%E5%99%A8-%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8B%A6%E6%88%AA%E5%99%A8/" class="article-nav-link">
        <strong class="article-nav-caption">下一篇</strong>
        <div class="article-nav-title">Flume拦截器-自定义拦截器</div>
      </a>
    
  </nav>

   
<!-- valine评论 -->
<div id="vcomments-box">
  <div id="vcomments"></div>
</div>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js"></script>
<script>
  new Valine({
    el: "#vcomments",
    app_id: "",
    app_key: "",
    path: window.location.pathname,
    avatar: "monsterid",
    placeholder: "给我的文章加点评论吧~",
    recordIP: true,
  });
  const infoEle = document.querySelector("#vcomments .info");
  if (infoEle && infoEle.childNodes && infoEle.childNodes.length > 0) {
    infoEle.childNodes.forEach(function (item) {
      item.parentNode.removeChild(item);
    });
  }
</script>
<style>
  #vcomments-box {
    padding: 5px 30px;
  }

  @media screen and (max-width: 800px) {
    #vcomments-box {
      padding: 5px 0px;
    }
  }

  #vcomments-box #vcomments {
    background-color: #fff;
  }

  .v .vlist .vcard .vh {
    padding-right: 20px;
  }

  .v .vlist .vcard {
    padding-left: 10px;
  }
</style>

 
   
     
</article>

</section>
      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2015-2021
        <i class="ri-heart-fill heart_icon"></i> Movle
      </li>
    </ul>
    <ul>
      <li>
        
      </li>
    </ul>
    <ul>
      <li>
        
        
        <span>
  <span><i class="ri-user-3-fill"></i>访问人数:<span id="busuanzi_value_site_uv"></span></span>
  <span class="division">|</span>
  <span><i class="ri-eye-fill"></i>浏览次数:<span id="busuanzi_value_page_pv"></span></span>
</span>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzz统计 -->
        
        <script type="text/javascript" src='https://s9.cnzz.com/z_stat.php?id=1278069914&amp;web_id=1278069914'></script>
        
      </li>
    </ul>
  </div>
</footer>    
    </main>
    <div class="float_btns">
      <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

    </div>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="https://img-blog.csdnimg.cn/20200609161448519.jpg" alt="Movle"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">归档</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">分类</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">标签</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/about">关于我</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="搜索">
        <i class="ri-search-line"></i>
      </a>
      
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/img/alipay.jpg">
      <span class="reward-type">支付宝</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/img/wechat.jpg">
      <span class="reward-type">微信</span>
    </div>
    
  </div>
</div>
    
<script src="/js/jquery-3.6.0.min.js"></script>
 
<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->
 
<script src="/js/tocbot.min.js"></script>

<script>
  tocbot.init({
    tocSelector: ".tocbot",
    contentSelector: ".article-entry",
    headingSelector: "h1, h2, h3, h4, h5, h6",
    hasInnerContainers: true,
    scrollSmooth: true,
    scrollContainer: "main",
    positionFixedSelector: ".tocbot",
    positionFixedClass: "is-position-fixed",
    fixedSidebarOffset: "auto",
  });
</script>

<script src="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.js"></script>
<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.css"
/>
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->
 <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css">
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script> 
<!-- MathJax -->

<!-- Katex -->

<!-- busuanzi  -->
 
<script src="/js/busuanzi-2.3.pure.min.js"></script>
 
<!-- ClickLove -->

<!-- ClickBoom1 -->

<!-- ClickBoom2 -->

<!-- CodeCopy -->
 
<link rel="stylesheet" href="/css/clipboard.css">
 <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>
 
<!-- CanvasBackground -->

<script>
  if (window.mermaid) {
    mermaid.initialize({ theme: "forest" });
  }
</script>


    
    

  </div>
</body>

</html>